USE FOODIE_FI;
CREATE or replace table NT_SALES
(
PRODUCT_ID INT,
SALE_DATE DATE,
DAILY_SALES DECIMAL (8,2));

INSERT INTO NT_SALES VALUES
(1000, '2000-09-28', 48850.40),
(1000, '2000-09-29', 54500.22),
(1000, '2000-09-30', 36000.07),
(1000, '2000-10-01', 40200.43),
(2000, '2000-09-28', 41888.88),
(2000, '2000-09-29', 48000.00),
(2000, '2000-09-30', 49850.03),
(2000, '2000-10-01', 54850.29),
(3000, '2000-09-28', 61301.77),
(3000, '2000-09-29', 34509.13),
(3000, '2000-09-30', 43868.86),
(3000, '2000-10-01', 28000.00);

SELECT * FROM NT_SALES;

-- FIRST VALUE --
SELECT 
      COLUMN1,
      COLUMN2,
      FIRST_VALUE(COLUMN2) OVER (PARTITION BY COLUMN1 ORDER BY COLUMN2 NULLS LAST) AS COLUMN2_FIRST
FROM VALUES
(1, 10), (1, 11), (1, NULL), (1, 12),
(2, 20), (2, 21), (2, 22)
ORDER BY COLUMN1, COLUMN2;

-- LAST VALUE --

SELECT 
      COLUMN1,
      COLUMN2,
      LAST_VALUE(COLUMN2) OVER (PARTITION BY COLUMN1 ORDER BY COLUMN2 NULLS LAST) AS COLUMN2_LAST
FROM VALUES
(1, 10), (1, 11),(1, NULL), (1, 12),
(2, 20), (2, 21), (2, 22)
ORDER BY COLUMN1, COLUMN2;

SELECT 
      COLUMN1,
      COLUMN2,
      LAST_VALUE(COLUMN2) IGNORE NULLS OVER (PARTITION BY COLUMN1 ORDER BY COLUMN2 NULLS LAST) AS COLUMN2_LAST_WITHOUT_NULLS
FROM VALUES
(1, 10), (1, 11), (1, NULL), (1, 12),
(2, 20), (2, 21), (2, 22)
ORDER BY COLUMN1, COLUMN2;

SELECT 
      COLUMN1,
      COLUMN2,
      FIRST_VALUE(COLUMN2) OVER (PARTITION BY COLUMN1 ORDER BY COLUMN2 NULLS LAST) AS COLUMN2_FIRST,
      FIRST_VALUE(COLUMN2) IGNORE NULLS OVER (PARTITION BY COLUMN1 ORDER BY COLUMN2 NULLS LAST) AS COLUMN2_FIRST_WITHOUT_NULLS,
       LAST_VALUE(COLUMN2) OVER (PARTITION BY COLUMN1 ORDER BY COLUMN2 NULLS LAST) AS COLUMN2_LAST,
       LAST_VALUE(COLUMN2) IGNORE NULLS OVER (PARTITION BY COLUMN1 ORDER BY COLUMN2 NULLS LAST) AS COLUMN2_LAST_WITHOUT_NULLS
FROM VALUES
(1, 10), (1, 11), (1, NULL), (1, 12),
(2, 20), (2, 21), (2, 22)
ORDER BY COLUMN1, COLUMN2;